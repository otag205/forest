<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üå≤ –õ–µ—Å–Ω–æ–µ –≤—ã–∂–∏–≤–∞–Ω–∏–µ üå≤</title>
    <style>
        /* –°—Ç–∏–ª–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (—Ç–∞–∫–∏–µ –∂–µ, –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏) */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: #1f3b1a;
            background-image: repeating-linear-gradient(45deg, #2b4d24 0px, #2b4d24 2px, #1f3b1a 2px, #1f3b1a 8px);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
            font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', sans-serif;
        }

        .game-wrapper {
            max-width: 900px;
            width: 100%;
            position: relative;
        }

        .leaf-decoration {
            position: absolute;
            top: -30px;
            left: -30px;
            right: -30px;
            bottom: -30px;
            pointer-events: none;
            z-index: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" opacity="0.2"><path fill="%233d8c40" d="M50,30 Q70,10 90,30 Q100,50 80,70 Q60,80 40,70 Q20,60 30,40 Q35,30 50,30Z" /><path fill="%233d8c40" d="M140,120 Q160,100 180,120 Q190,140 170,160 Q150,170 130,160 Q110,150 120,130 Q125,120 140,120Z" /><path fill="%233d8c40" d="M30,150 Q50,130 70,150 Q80,170 60,190 Q40,200 20,180 Q10,160 30,150Z" /></svg>');
            background-repeat: repeat;
            background-size: 150px 150px;
        }

        .game-container {
            background: #2d4427;
            background: linear-gradient(145deg, #2d5a2a, #1d3a1a);
            border: 8px solid #6b4f2b;
            border-radius: 70px 70px 30px 30px;
            box-shadow: 0 25px 35px rgba(0,0,0,0.8), inset 0 0 30px #a18b54;
            padding: 30px 25px;
            color: #faf3d7;
            position: relative;
            z-index: 1;
            transition: all 0.3s;
        }

        .game-container::before {
            content: "üåøüå≤üçÇüçÉüå±";
            font-size: 70px;
            position: absolute;
            top: -30px;
            left: -30px;
            opacity: 0.2;
            transform: rotate(-15deg);
            white-space: nowrap;
            pointer-events: none;
        }

        .game-container::after {
            content: "";
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 180px;
            height: 180px;
            background: radial-gradient(circle at 20px 30px, #3f722a 5px, transparent 7px), 
                        repeating-linear-gradient(45deg, #4c7a3a 0px, #4c7a3a 4px, #2f5427 4px, #2f5427 8px);
            border-radius: 60% 40% 70% 30%;
            opacity: 0.15;
            transform: rotate(20deg);
            pointer-events: none;
        }

        h1 {
            font-size: 3.5rem;
            text-align: center;
            font-weight: 800;
            text-shadow: 5px 5px 0 #2c4d1a, 7px 7px 0 #1a3110, 0 10px 15px black;
            margin-bottom: 20px;
            letter-spacing: 4px;
            word-break: break-word;
            color: #ffefc0;
            filter: drop-shadow(0 4px 2px rgba(0,0,0,0.5));
        }

        .stats-panel {
            background: #295321;
            background: linear-gradient(to bottom, #3b6933, #1f4219);
            border: 4px solid #b3914b;
            border-radius: 80px 80px 40px 40px;
            padding: 20px;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            gap: 20px;
            margin-bottom: 25px;
            box-shadow: inset 0 5px 10px #14280f, 0 12px 0 #4b3b1f;
        }

        .stat-item {
            background: #173312;
            border-radius: 60px;
            padding: 12px 25px;
            min-width: 140px;
            text-align: center;
            border: 3px solid #ebc471;
            box-shadow: inset 0 -5px 0 #6b4f1f, 0 6px 0 #3b2e12;
            font-size: 1.3rem;
            font-weight: bold;
            color: #faf0bb;
        }

        .stat-value {
            font-size: 2.4rem;
            font-weight: 800;
            line-height: 1.2;
            color: #fff3a0;
            text-shadow: 3px 3px 0 #2f621f;
        }

        .inventory-box {
            background: #2f5827;
            border: 4px solid #b7974f;
            border-radius: 60px 60px 30px 30px;
            padding: 20px;
            margin: 25px 0;
            box-shadow: inset 0 0 15px #1c3d14, 0 10px 0 #5a431f;
        }

        .inventory-title {
            font-size: 2.2rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 3px dashed #c7af6b;
            padding-bottom: 10px;
            text-shadow: 2px 2px 0 #1e3a12;
        }

        .inventory-items {
            background: #1d3e18;
            border-radius: 50px;
            padding: 20px;
            min-height: 90px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            border: 2px solid #b49447;
            box-shadow: inset 0 4px 8px #0b2009;
        }

        .item-tag {
            background: #5f874b;
            background: linear-gradient(145deg, #77a35c, #4f703b);
            color: #fff7cf;
            padding: 12px 28px;
            border-radius: 50px;
            font-size: 1.3rem;
            font-weight: 600;
            box-shadow: 0 7px 0 #2a4a1f, inset 0 2px 8px #ebdd9c;
            border: 1px solid #f3dea2;
            text-transform: lowercase;
            transition: 0.1s;
            backdrop-filter: blur(2px);
        }

        .item-tag::first-letter {
            text-transform: uppercase;
        }

        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin: 30px 0 20px;
            justify-content: center;
        }

        .action-btn {
            background: #84a76b;
            background: linear-gradient(to bottom, #9fc085, #5e8249);
            border: none;
            border-bottom: 8px solid #325023;
            font-size: 2.2rem;
            font-weight: 800;
            padding: 20px 30px;
            min-width: 170px;
            border-radius: 90px;
            color: #1a2e13;
            text-shadow: 2px 2px 0 #c7e2a8;
            cursor: pointer;
            box-shadow: 0 12px 0 #2a451f, 0 15px 20px black;
            transition: all 0.08s linear;
            flex: 1 1 auto;
            letter-spacing: 2px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .action-btn:active {
            transform: translateY(8px);
            border-bottom-width: 3px;
            box-shadow: 0 6px 0 #2a451f;
        }

        .action-btn:disabled {
            opacity: 0.4;
            transform: translateY(5px);
            border-bottom-width: 4px;
            pointer-events: none;
            filter: grayscale(0.6);
        }

        .special-btn {
            background: #cdb87a;
            background: linear-gradient(to bottom, #eedb9f, #b89f5a);
            border-bottom-color: #755e2a;
            color: #2f2a10;
            text-shadow: 2px 2px 0 #ffeeaa;
        }

        .log-area {
            background: #1d341a;
            border: 5px solid #876f3b;
            border-radius: 50px 50px 25px 25px;
            padding: 20px;
            margin-top: 30px;
            max-height: 280px;
            overflow-y: auto;
            font-size: 1.3rem;
            line-height: 1.6;
            box-shadow: inset 0 0 30px #0e230c, 0 8px 0 #4f3e1f;
            color: #ede3ae;
            scrollbar-width: thin;
            scrollbar-color: #a58f4d #1e3a14;
        }

        .log-area::-webkit-scrollbar {
            width: 12px;
        }
        .log-area::-webkit-scrollbar-track {
            background: #1e3a14;
            border-radius: 20px;
        }
        .log-area::-webkit-scrollbar-thumb {
            background: #a58f4d;
            border-radius: 20px;
            border: 2px solid #4b6a2e;
        }

        .log-message {
            padding: 8px 0;
            border-bottom: 1px solid #6f9146;
        }
        .log-message:last-child {
            border: none;
        }

        .start-screen {
            text-align: center;
            padding: 20px;
        }

        .difficulty-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            justify-content: center;
            margin: 40px 0;
        }

        .diff-btn {
            background: #53833b;
            background: radial-gradient(circle at 30% 20%, #8fc77a, #356128);
            border: 6px solid #fbdf93;
            padding: 25px 45px;
            font-size: 2.5rem;
            font-weight: 800;
            border-radius: 90px;
            color: #1f3815;
            cursor: pointer;
            box-shadow: 0 15px 0 #2c4b1c, 0 20px 25px black;
            transition: 0.05s linear;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .diff-btn:active {
            transform: translateY(10px);
            box-shadow: 0 5px 0 #2c4b1c;
        }

        .hidden {
            display: none !important;
        }

        .use-item-panel {
            background: #34632a;
            background: linear-gradient(145deg, #49853b, #1e4717);
            border: 5px solid #edcb7a;
            border-radius: 70px;
            padding: 25px;
            margin: 25px 0 15px;
            box-shadow: inset 0 0 20px #9ccf82, 0 12px 0 #5d421c;
            transform-origin: top;
            animation: slideDown 0.2s ease-out;
        }

        @keyframes slideDown {
            0% { opacity: 0; transform: translateY(-20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        .use-item-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
        }

        .use-item-input {
            flex: 3;
            background: #1b3b15;
            border: 4px solid #fad779;
            border-radius: 70px;
            padding: 18px 25px;
            font-size: 1.5rem;
            color: #fffcd1;
            outline: none;
            box-shadow: inset 0 5px 10px #0b2007;
        }

        .use-item-input::placeholder {
            color: #9fc087;
            font-style: italic;
        }

        .small-btn {
            background: #eed894;
            background: linear-gradient(to bottom, #ffeaa5, #c9aa54);
            border: none;
            border-bottom: 6px solid #83672b;
            font-size: 1.7rem;
            font-weight: bold;
            padding: 15px 30px;
            border-radius: 70px;
            cursor: pointer;
            flex: 1;
            min-width: 150px;
            box-shadow: 0 8px 0 #5c451c, 0 5px 15px black;
            transition: 0.05s;
            color: #1a2d0f;
        }

        .small-btn:active {
            transform: translateY(5px);
            border-bottom-width: 2px;
            box-shadow: 0 3px 0 #5c451c;
        }

        .close-btn {
            background: #bd9d64;
            background: linear-gradient(to bottom, #dbbc7c, #9e7d42);
            border-bottom-color: #60431b;
        }

        .forest-icon {
            font-size: 2rem;
            filter: drop-shadow(2px 4px 4px #00000066);
        }

        .extra-notice {
            background: #2d5423;
            border-radius: 40px;
            padding: 10px 20px;
            font-size: 1.2rem;
            color: #ffe48f;
            text-align: center;
            margin-top: 10px;
            border: 2px solid #c1a351;
        }

        .restart-btn {
            background: #b68b54;
            border: 4px solid #fbdf93;
            font-size: 2rem;
            padding: 15px 30px;
            border-radius: 80px;
            color: #1f3815;
            cursor: pointer;
            font-weight: bold;
            margin: 20px auto 0;
            display: block;
            box-shadow: 0 8px 0 #5a431f;
            transition: 0.05s;
            width: fit-content;
        }

        .restart-btn:active {
            transform: translateY(5px);
            box-shadow: 0 3px 0 #5a431f;
        }

        .restart-btn.hidden {
            display: none;
        }
    </style>
</head>
<body>
<div class="game-wrapper">
    <div class="leaf-decoration"></div>
    <div class="game-container" id="gameContainer">
        <!-- –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ -->
        <div id="startScreen" class="start-screen">
            <h1><span class="forest-icon">üå≤</span> –õ–ï–°–ù–û–ï –í–´–ñ–ò–í–ê–ù–ò–ï <span class="forest-icon">üå≤</span></h1>
            <div style="font-size: 1.8rem; background: #1e3d1a; padding: 25px; border-radius: 70px; border: 3px solid #cfa55a;">
                <p>‚úß –Ω–∞–±–µ—Ä–∏—Ç–µ 20 —ç–Ω–µ—Ä–≥–∏–∏ ‚úß<br>‚úß —Å–¥–µ–ª–∞–π—Ç–µ ‚â•10 —à–∞–≥–æ–≤ ‚úß<br>‚úß —Å–æ–≤–µ—Ä—à–∏—Ç–µ ‚â•5 –ø—Ä–æ–±–µ–∂–µ–∫ ‚úß<br>‚úß –Ω–∞–π–¥–∏—Ç–µ –ö–û–ú–ü–ê–° ‚úß</p>
            </div>
            <div class="difficulty-selector">
                <div class="diff-btn" data-diff="–ª–µ–≥–∫–æ">üå± –õ–ï–ì–ö–û</div>
                <div class="diff-btn" data-diff="—Å—Ä–µ–¥–Ω–µ">üçÇ –°–†–ï–î–ù–ï</div>
                <div class="diff-btn" data-diff="—Å–ª–æ–∂–Ω–æ">üå™Ô∏è –°–õ–û–ñ–ù–û</div>
            </div>
            <div class="extra-notice">–≤—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å —Å—Ç—Ä–∞—Ö–∞ :)</div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω -->
        <div id="gameScreen" class="hidden">
            <h1>üèïÔ∏è –í –õ–ï–°–£</h1>

            <div class="stats-panel">
                <div class="stat-item"><span class="forest-icon">‚ö°</span> –≠–Ω–µ—Ä–≥–∏—è<br><span class="stat-value" id="energyVal">0</span></div>
                <div class="stat-item"><span class="forest-icon">üö∂</span> –®–∞–≥–∏<br><span class="stat-value" id="stepsVal">0</span></div>
                <div class="stat-item"><span class="forest-icon">üèÉ</span> –ü—Ä–æ–±–µ–∂–∫–∏<br><span class="stat-value" id="runVal">0</span></div>
                <div class="stat-item"><span class="forest-icon">üî¢</span> –•–æ–¥<br><span class="stat-value" id="turnVal">1</span></div>
            </div>

            <div class="inventory-box">
                <div class="inventory-title"><span class="forest-icon">üéí</span> –ò–ù–í–ï–ù–¢–ê–†–¨</div>
                <div class="inventory-items" id="inventoryContainer"></div>
            </div>

            <div class="action-buttons">
                <button class="action-btn" id="goBtn"><span class="forest-icon">üö∂</span> –ò–î–¢–ò</button>
                <button class="action-btn" id="restBtn"><span class="forest-icon">üò¥</span> –û–¢–î–´–•–ê–¢–¨</button>
                <button class="action-btn" id="runBtn"><span class="forest-icon">üèÉ</span> –ë–ï–ñ–ê–¢–¨</button>
                <button class="action-btn special-btn" id="statusBtn"><span class="forest-icon">üì¶</span> –†–Æ–ö–ó–ê–ö</button>
            </div>

            <div id="useItemPanel" class="use-item-panel hidden">
                <div style="font-size: 2rem; margin-bottom: 15px;">üçÑ –ß—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?</div>
                <div class="use-item-controls">
                    <input type="text" id="itemInput" class="use-item-input" placeholder="–Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞" autocomplete="off">
                    <button class="small-btn" id="useItemBtn">üëç –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨</button>
                    <button class="small-btn close-btn" id="closeUsePanelBtn">‚ùå –ó–ê–ö–†–´–¢–¨ –†–Æ–ö–ó–ê–ö</button>
                </div>
                <div class="extra-notice" style="margin-top: 15px;">* –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: —è–≥–æ–¥—ã, –æ—Ä–µ—à–∫–∏, —á–µ–π-—Ç–æ –±—É—Ç–µ—Ä–±—Ä–æ–¥, –ø–∏—Ä–æ–≥, —è–±–ª–æ–∫–æ, —Ç—Ä–æ—Å—Ç—å, –∫–æ–º–ø–∞—Å</div>
            </div>

            <div class="log-area" id="logContainer">
                <div class="log-message">üå≥ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ª–µ—Å...</div>
            </div>

            <button id="restartBtn" class="restart-btn hidden">üîÑ –ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
        </div>
    </div>
</div>

<script>
    (function() {
        // ---------- –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ----------
        let hod = 1;
        let steps = 0;
        let run = 0;
        let e = 0;
        let inventory = [];
        let gameActive = true;
        let difficulty = "";

        const loot = ["—è–≥–æ–¥—ã", "–æ—Ä–µ—à–∫–∏", "—á–µ–π-—Ç–æ –±—É—Ç–µ—Ä–±—Ä–æ–¥", "–Ω–∏—á–µ–≥–æ"];

        // DOM-—ç–ª–µ–º–µ–Ω—Ç—ã
        const startScreen = document.getElementById('startScreen');
        const gameScreen = document.getElementById('gameScreen');
        const energySpan = document.getElementById('energyVal');
        const stepsSpan = document.getElementById('stepsVal');
        const runSpan = document.getElementById('runVal');
        const turnSpan = document.getElementById('turnVal');
        const inventoryDiv = document.getElementById('inventoryContainer');
        const logContainer = document.getElementById('logContainer');
        const useItemPanel = document.getElementById('useItemPanel');
        const itemInput = document.getElementById('itemInput');
        const useItemBtn = document.getElementById('useItemBtn');
        const closeUsePanelBtn = document.getElementById('closeUsePanelBtn');
        const restartBtn = document.getElementById('restartBtn');

        const goBtn = document.getElementById('goBtn');
        const restBtn = document.getElementById('restBtn');
        const runBtn = document.getElementById('runBtn');
        const statusBtn = document.getElementById('statusBtn');

        // –ö–Ω–æ–ø–∫–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
        document.querySelectorAll('.diff-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                difficulty = e.target.getAttribute('data-diff');
                startGame(difficulty);
            });
        });

        // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
        restartBtn.addEventListener('click', () => {
            gameScreen.classList.add('hidden');
            startScreen.classList.remove('hidden');
            disableButtons(true);
            gameActive = true;
            useItemPanel.classList.add('hidden');
            restartBtn.classList.add('hidden');
        });

        function addLog(message) {
            const msgDiv = document.createElement('div');
            msgDiv.className = 'log-message';
            msgDiv.textContent = message;
            logContainer.appendChild(msgDiv);
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        function clearLog() {
            logContainer.innerHTML = '';
        }

        function updateUI() {
            energySpan.textContent = e;
            stepsSpan.textContent = steps;
            runSpan.textContent = run;
            turnSpan.textContent = hod;

            inventoryDiv.innerHTML = '';
            if (inventory.length === 0) {
                inventoryDiv.innerHTML = '<div class="item-tag" style="background: #416336;">üß∫ –ø—É—Å—Ç–æ</div>';
            } else {
                inventory.forEach(item => {
                    const tag = document.createElement('div');
                    tag.className = 'item-tag';
                    let icon = '';
                    if (item.includes('—è–≥–æ–¥')) icon = 'üçì';
                    else if (item.includes('–æ—Ä–µ—à')) icon = 'ü•ú';
                    else if (item.includes('–±—É—Ç–µ—Ä–±—Ä–æ–¥')) icon = 'ü•™';
                    else if (item.includes('–ø–∏—Ä–æ–≥')) icon = 'ü•ß';
                    else if (item.includes('—è–±–ª–æ–∫')) icon = 'üçé';
                    else if (item.includes('—Ç—Ä–æ—Å—Ç—å')) icon = 'ü©º';
                    else if (item.includes('–∫–æ–º–ø–∞—Å')) icon = 'üß≠';
                    else icon = 'üì¶';
                    tag.textContent = icon + ' ' + item;
                    inventoryDiv.appendChild(tag);
                });
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –ø—Ä–µ–¥–º–µ—Ç–∞ (–∫–∞–∫ list.remove –≤ Python)
        function removeOneFromInventory(itemName) {
            const index = inventory.indexOf(itemName);
            if (index !== -1) {
                inventory.splice(index, 1);
            }
        }

        function checkWinLose() {
            if (e >= 20 && steps >= 10 && run >= 5 && inventory.includes("–∫–æ–º–ø–∞—Å")) {
                const wins = [
                    "–í—ã —Å–º–æ–≥–ª–∏ —Å–±–µ–∂–∞—Ç—å –∏–∑ –ª–µ—Å–∞ –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –¥–æ–º–æ–π",
                    "–ü–µ—Ä–µ–ø—É–≥–∞–Ω–Ω—ã–µ –±–ª–∏–∑–∫–∏–µ –Ω–∞—à–ª–∏ –≤–∞—Å, –≤–∞–º –ø—Ä–∏—à–ª–æ—Å—å –ª–µ–∂–∞—Ç—å –≤ –±–æ–ª—å–Ω–∏—Ü–µ, –Ω–æ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –≤—Å—ë –≤–µ—Ä–Ω—É–ª–æ—Å—å –Ω–∞ –∫—Ä—É–≥–∏ —Å–≤–æ—è",
                    "–í–∞—Å –Ω–∞—à–ª–∏ —Å–ø–∞—Å–∞—Ç–µ–ª–∏, –≤—Å—ë –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å —Ö–æ—Ä–æ—à–æ",
                    "–í—ã —Å–º–æ–≥–ª–∏ —Å–±–µ–∂–∞—Ç—å, –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã –±–æ–ª—å—à–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö–æ–¥–∏–ª–∏ –≤ –ª–µ—Å"
                ];
                addLog("‚ú®‚ú®‚ú® –ü–û–ë–ï–î–ê ‚ú®‚ú®‚ú®");
                addLog(randomChoice(wins));
                gameActive = false;
                disableButtons(true);
                useItemPanel.classList.add('hidden');
                restartBtn.classList.remove('hidden');
                return;
            }
            if (e <= 0) {
                const deaths = [
                    "–í—ã —É—Å–Ω—É–ª–∏ –ø–æ–¥ –∫—É—Å—Ç–æ–º. –ù–∞–≤—Å–µ–≥–¥–∞",
                    "–õ–µ—Å –ø—Ä–∏–Ω—è–ª –≤–∞—Å –≤ —Å–≤–æ–∏ –æ–±—ä—è—Ç–∏—è. –ù–∞–≤—Å–µ–≥–¥–∞",
                    "–ì—Ä–∏–±–Ω–∏–∫–∏ –Ω–∞–π–¥—É—Ç –≤–∞—à–∏ –∫–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –≥–æ–¥",
                    "–í—ã —Å—Ç–∞–ª–∏ —á–∞—Å—Ç—å—é —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã"
                ];
                addLog("üíÄüíÄüíÄ –í–´ –ü–û–ì–ò–ë–õ–ò üíÄüíÄüíÄ");
                addLog(randomChoice(deaths));
                gameActive = false;
                disableButtons(true);
                useItemPanel.classList.add('hidden');
                restartBtn.classList.remove('hidden');
                return;
            }
            if (e >= 20 && (steps < 10 || run < 5 || !inventory.includes("–∫–æ–º–ø–∞—Å"))) {
                addLog("–≠–Ω–µ—Ä–≥–∏–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –Ω–æ –Ω—É–∂–Ω–æ –µ—â—ë —Ö–æ–¥–∏—Ç—å/–±–µ–≥–∞—Ç—å –∏–ª–∏ –Ω–∞–π—Ç–∏ –∫–æ–º–ø–∞—Å");
            }
        }

        function disableButtons(disabled) {
            const btns = [goBtn, restBtn, runBtn, statusBtn, useItemBtn, closeUsePanelBtn];
            btns.forEach(b => b.disabled = disabled);
        }

        function randomChoice(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        function startGame(diff) {
            hod = 1;
            steps = 0;
            run = 0;
            inventory = [];
            gameActive = true;

            if (diff === "–ª–µ–≥–∫–æ") {
                e = 20;
                addLog("–£—Ç—Ä–æ–º –≤—ã —Ä–µ—à–∏–ª–∏ –ø–æ–π—Ç–∏ —Å–æ–±–∏—Ä–∞—Ç—å –≥—Ä–∏–±—ã –∏ —è–≥–æ–¥—ã –≤ –ª–µ—Å. –£ –≤–∞—Å –º–Ω–æ–≥–æ —Å–∏–ª, –≤—ã –≤—ã—Å–ø–∞–ª–∏—Å—å –∏ –≤–∫—É—Å–Ω–æ –ø–æ–∫—É—à–∞–ª–∏ –ø–µ—Ä–µ–¥ –≤—ã—Ö–æ–¥–æ–º. –ù–æ –≤—ã –∑–∞–±–ª—É–¥–∏–ª–∏—Å—å, –≤–∞–º –Ω—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å—Å—è –∏–∑ –ª–µ—Å–∞");
            } else if (diff === "—Å–ª–æ–∂–Ω–æ") {
                e = 5;
                addLog("–í—ã —à–ª–∏ —á–µ—Ä–µ–∑ –ª–µ—Å –Ω–æ—á—å—é –ø–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã, —á—Ç–æ–±—ã —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –ø—É—Ç—å –¥–æ–º–æ–π. –£ –≤–∞—Å –ø–æ—á—Ç–∏ –Ω–µ—Ç —Å–∏–ª, –≤—ã –≤—ã–º–æ—Ç–∞–Ω—ã, –Ω–æ –¥–æ–º–∞ –∂–¥—É—Ç, –≤–∞–º –Ω–∞–¥–æ –≤—ã–±—Ä–∞—Ç—å—Å—è");
            } else if (diff === "—Å—Ä–µ–¥–Ω–µ") {
                e = 15;
                addLog("–í—ã –ø–æ—à–ª–∏ –≤ –ª–µ—Å –∑–∞ —Ö–≤–æ—Ä–æ—Å—Ç–æ–º –¥–ª—è –∫–æ—Å—Ç—Ä–∞. –î–µ–Ω—å –≤—ã–¥–∞–ª—Å—è –æ–±—ã—á–Ω—ã–π, —Å–∏–ª —Ö–≤–∞—Ç–∏—Ç –Ω–µ–Ω–∞–¥–æ–ª–≥–æ, –Ω–æ –≤—ã –∑–Ω–∞–µ—Ç–µ —ç—Ç–∏ –º–µ—Å—Ç–∞... –∏–ª–∏ —Ç–æ–ª—å–∫–æ –∫–∞–∑–∞–ª–æ—Å—å?");
            } else {
                e = 8;
                addLog("–°—Ç—Ä–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä, –Ω–æ –≤—ã —É–∂–µ –≤ –ª–µ—Å—É. –ü—Ä–∏–¥—ë—Ç—Å—è –≤—ã–∂–∏–≤–∞—Ç—å –∫–∞–∫ –µ—Å—Ç—å");
            }

            startScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            clearLog();
            updateUI();
            disableButtons(false);
            useItemPanel.classList.add('hidden');
            restartBtn.classList.add('hidden');
            addLog(`–≠–Ω–µ—Ä–≥–∏—è: ${e}`);
        }

        // ---------- –û—Å–Ω–æ–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è ----------
        function goAction() {
            if (!gameActive) return;
            hod++;
            e -= 1;
            steps += 1;
            addLog("–í—ã –ø–æ—à–ª–∏ –¥–∞–ª—å—à–µ -1");

            let chance = Math.floor(Math.random() * 5) + 1;
            if (chance === 1) {
                e -= 1;
                addLog("–í—ã —Å–ø–æ—Ç–∫–Ω—É–ª–∏—Å—å -1");
            } else if (chance === 5) {
                e += 3;
                addLog("–í—ã –ø–æ—Ö–æ–¥–∏–ª–∏ –ø–æ –º—è–≥–∫–æ–º—É –º—Ö—É +3");
            } else if (chance === 3) {
                e += 1;
                addLog("–í—ã –ø—Ä–æ—à–ª–∏—Å—å –ø–æ —Ç–µ–Ω—ë—á–∫—É +1");
            } else if (chance === 4) {
                e -= 4;
                addLog("–í—ã –Ω–∞—Å—Ç—É–ø–∏–ª–∏ –≤ –≥–ª—É–±–æ–∫—É—é –ª—É–∂—É -4");
            }

            let rare = Math.floor(Math.random() * 10) + 1;
            if (rare === 5) {
                e -= 5;
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í—ã –ø–æ–ø–∞–ª–∏ –≤ —á—å—é —Ç–æ –ª–æ–≤—É—à–∫—É -5");
            } else if (rare === 6) {
                e += 5;
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í—ã –Ω–∞—à–ª–∏ —Ç—Ä–æ—Å—Ç—å, —Å –Ω–µ–π —Ö–æ–¥–∏—Ç—å –±—É–¥–µ—Ç –ø—Ä–æ—â–µ +5");
                inventory.push("—Ç—Ä–æ—Å—Ç—å");
                addLog("—Ç—Ä–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä—é–∫–∑–∞–∫!");
            }

            let rareGlobal = Math.floor(Math.random() * 15) + 1;
            if (rareGlobal === 1) {
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í—ã –Ω–∞—à–ª–∏ –ø–∏—Ä–æ–≥");
                inventory.push("–ø–∏—Ä–æ–≥");
                addLog("–ü–∏—Ä–æ–≥ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä—é–∫–∑–∞–∫!");
            } else if (rareGlobal === 2) {
                e -= 7;
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í—ã –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏ –º–µ–¥–≤–µ–¥—è -7");
            } else if (rareGlobal === 3) {
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í—ã –Ω–∞—à–ª–∏ –Ω–∞ —Ä–µ–¥–∫–æ—Å—Ç—å –≤–∫—É—Å–Ω–æ–µ —è–±–ª–æ–∫–æ");
                inventory.push("—è–±–ª–æ–∫–æ");
                addLog("–Ø–±–ª–æ–∫–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä—é–∫–∑–∞–∫!");
            } else if (rareGlobal === 4) {
                e -= 2;
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í–∞—Å —É–∫—É—Å–∏–ª –∫–æ–º–∞—Ä -2 —ç–Ω–µ—Ä–≥–∏–∏");
            }

            let rareCompass = Math.floor(Math.random() * 20) + 1;
            if (rareCompass === 20) {
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í—ã –Ω–∞—à–ª–∏ –∫–æ–º–ø–∞—Å!");
                inventory.push("–∫–æ–º–ø–∞—Å");
                addLog("–ö–æ–º–ø–∞—Å –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä—é–∫–∑–∞–∫!");
            }

            if (hod % 6 === 0) {
                let found = randomChoice(loot);
                addLog(`–í—ã –Ω–∞—à–ª–∏: ${found}`);
                if (found === "—è–≥–æ–¥—ã") {
                    inventory.push("—è–≥–æ–¥—ã");
                    addLog("–Ø–≥–æ–¥—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ä—é–∫–∑–∞–∫!");
                } else if (found === "–æ—Ä–µ—à–∫–∏") {
                    inventory.push("–æ—Ä–µ—à–∫–∏");
                    addLog("–û—Ä–µ—à–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ä—é–∫–∑–∞–∫!");
                } else if (found === "—á–µ–π-—Ç–æ –±—É—Ç–µ—Ä–±—Ä–æ–¥") {
                    inventory.push("—á–µ–π-—Ç–æ –±—É—Ç–µ—Ä–±—Ä–æ–¥");
                    addLog("—á–µ–π-—Ç–æ –±—É—Ç–µ—Ä–±—Ä–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä—é–∫–∑–∞–∫!");
                }
            }

            if (inventory.includes("—Ç—Ä–æ—Å—Ç—å")) {
                e += 1;
                addLog("–° —Ç—Ä–æ—Å—Ç—å—é –≤–∞–º –ø—Ä–æ—â–µ +1");
                if (Math.floor(Math.random() * 10) + 1 === 10) {
                    removeOneFromInventory("—Ç—Ä–æ—Å—Ç—å");
                    addLog(randomChoice([
                        "–í–∞—à–∞ —Ç—Ä–æ—Å—Ç—å –∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é —Å–ª–æ–º–∞–ª–∞—Å—å",
                        "–í—ã –ø–æ—Ç–µ—Ä—è–ª–∏ —Å–≤–æ—é —Ç—Ä–æ—Å—Ç—å"
                    ]));
                }
            }
            if (inventory.includes("–∫–æ–º–ø–∞—Å") && Math.floor(Math.random() * 30) + 1 === 30) {
                removeOneFromInventory("–∫–æ–º–ø–∞—Å");
                addLog(randomChoice([
                    "–ö–æ–º–ø–∞—Å —É–ø–∞–ª –Ω–∞ –∫–∞–º–µ–Ω—å –∏ —Ä–∞–∑–±–∏–ª—Å—è",
                    "–í—ã –ø–æ—Ç–µ—Ä—è–ª–∏ —Å–≤–æ–π –∫–æ–º–ø–∞—Å"
                ]));
            }

            addLog(`–≠–Ω–µ—Ä–≥–∏—è: ${e}`);
            updateUI();
            checkWinLose();
        }

        function restAction() {
            if (!gameActive) return;
            hod++;
            e += 2;
            addLog("–í—ã –æ—Ç–¥—ã—Ö–∞–µ—Ç–µ +2");

            let chance = Math.floor(Math.random() * 5) + 1;
            if (chance === 1) {
                e -= 4;
                addLog("–í–∞—Å —É–∂–∞–ª–∏–ª–∞ –ø—á–µ–ª–∞ -4");
            } else if (chance === 5) {
                e += 2;
                addLog("–ë–µ–ª–æ—á–∫–∞ –ø–æ–¥–µ–ª–∏–ª–∞—Å—å —Å –≤–∞–º–∏ –æ—Ä–µ—à–∫–∞–º–∏ +2");
                inventory.push("–æ—Ä–µ—à–∫–∏");
            } else if (chance === 3) {
                e += 1;
                addLog("–í—ã –Ω–∞—à–ª–∏ —Ö–æ—Ä–æ—à–µ–µ –º–µ—Å—Ç–µ—á–∫–æ –¥–ª—è –æ—Ç–¥—ã—Ö–∞ +1");
            } else if (chance === 4) {
                e -= 2;
                addLog("–ë—ã–ª–æ —Å–ª–∏—à–∫–æ–º –∂–∞—Ä–∫–æ –∏ –≤—ã –Ω–µ —Å–º–æ–≥–ª–∏ –æ—Ç–¥–æ—Ö–Ω—É—Ç—å -2");
            }

            let rareGlobal = Math.floor(Math.random() * 15) + 1;
            if (rareGlobal === 1) {
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í—ã –Ω–∞—à–ª–∏ –ø–∏—Ä–æ–≥");
                inventory.push("–ø–∏—Ä–æ–≥");
                addLog("–ü–∏—Ä–æ–≥ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä—é–∫–∑–∞–∫!");
            } else if (rareGlobal === 2) {
                e -= 7;
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í—ã –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏ –º–µ–¥–≤–µ–¥—è -7");
            } else if (rareGlobal === 3) {
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í—ã –Ω–∞—à–ª–∏ –Ω–∞ —Ä–µ–¥–∫–æ—Å—Ç—å –≤–∫—É—Å–Ω–æ–µ —è–±–ª–æ–∫–æ");
                inventory.push("—è–±–ª–æ–∫–æ");
                addLog("–Ø–±–ª–æ–∫–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä—é–∫–∑–∞–∫!");
            } else if (rareGlobal === 4) {
                e -= 2;
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í–∞—Å —É–∫—É—Å–∏–ª –∫–æ–º–∞—Ä -2 —ç–Ω–µ—Ä–≥–∏–∏");
            }

            let rareCompass = Math.floor(Math.random() * 20) + 1;
            if (rareCompass === 20) {
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í—ã –Ω–∞—à–ª–∏ –∫–æ–º–ø–∞—Å!");
                inventory.push("–∫–æ–º–ø–∞—Å");
                addLog("–ö–æ–º–ø–∞—Å –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä—é–∫–∑–∞–∫!");
            }

            if (hod % 6 === 0) {
                let found = randomChoice(loot);
                addLog(`–í—ã –Ω–∞—à–ª–∏: ${found}`);
                if (found === "—è–≥–æ–¥—ã") {
                    inventory.push("—è–≥–æ–¥—ã");
                    addLog("–Ø–≥–æ–¥—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ä—é–∫–∑–∞–∫!");
                } else if (found === "–æ—Ä–µ—à–∫–∏") {
                    inventory.push("–æ—Ä–µ—à–∫–∏");
                    addLog("–û—Ä–µ—à–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ä—é–∫–∑–∞–∫!");
                } else if (found === "—á–µ–π-—Ç–æ –±—É—Ç–µ—Ä–±—Ä–æ–¥") {
                    inventory.push("—á–µ–π-—Ç–æ –±—É—Ç–µ—Ä–±—Ä–æ–¥");
                    addLog("—á–µ–π-—Ç–æ –±—É—Ç–µ—Ä–±—Ä–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä—é–∫–∑–∞–∫!");
                }
            }

            if (inventory.includes("—Ç—Ä–æ—Å—Ç—å")) {
                e += 1;
                addLog("–° —Ç—Ä–æ—Å—Ç—å—é –≤–∞–º –ø—Ä–æ—â–µ +1");
                if (Math.floor(Math.random() * 10) + 1 === 10) {
                    removeOneFromInventory("—Ç—Ä–æ—Å—Ç—å");
                    addLog(randomChoice([
                        "–í–∞—à–∞ —Ç—Ä–æ—Å—Ç—å –∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é —Å–ª–æ–º–∞–ª–∞—Å—å",
                        "–í—ã –ø–æ—Ç–µ—Ä—è–ª–∏ —Å–≤–æ—é —Ç—Ä–æ—Å—Ç—å"
                    ]));
                }
            }
            if (inventory.includes("–∫–æ–º–ø–∞—Å") && Math.floor(Math.random() * 30) + 1 === 30) {
                removeOneFromInventory("–∫–æ–º–ø–∞—Å");
                addLog(randomChoice([
                    "–ö–æ–º–ø–∞—Å —É–ø–∞–ª –Ω–∞ –∫–∞–º–µ–Ω—å –∏ —Ä–∞–∑–±–∏–ª—Å—è",
                    "–í—ã –ø–æ—Ç–µ—Ä—è–ª–∏ —Å–≤–æ–π –∫–æ–º–ø–∞—Å"
                ]));
            }

            addLog(`–≠–Ω–µ—Ä–≥–∏—è: ${e}`);
            updateUI();
            checkWinLose();
        }

        function runAction() {
            if (!gameActive) return;
            hod++;
            e -= 3;
            run += 1;
            addLog("–í—ã –±–µ–∂–∏—Ç–µ -3");

            let chance = Math.floor(Math.random() * 5) + 1;
            if (chance === 1) {
                e -= 3;
                addLog("–í—ã —Å–ª–∏—à–∫–æ–º —É—Å—Ç–∞–ª–∏ -3");
            } else if (chance === 5) {
                e += 5;
                addLog("–í—ã –≤–∑–±–æ–¥—Ä–∏–ª–∏—Å—å –∏ –≤–∞–º —Å—Ç–∞–ª–æ —Ö–æ—Ä–æ—à–æ +5");
            } else if (chance === 3) {
                e += 9;
                addLog("–í—ã –ø–æ—Ç–æ—Ä–æ–ø–∏–ª–∏—Å—å –∏ –Ω–∞—à–ª–∏ –∫—É—á—É –±—Ä–æ—à–µ–Ω–Ω–æ–π –µ–¥—ã –ø–æ—Å–ª–µ –ø–∏–∫–Ω–∏–∫–∞ –±—ã—Å—Ç—Ä–µ–µ –∂–∏–≤–æ—Ç–Ω—ã—Ö +9");
            } else if (chance === 4) {
                e -= 6;
                addLog("–ü–æ–∫–∞ –±–µ–∂–∞–ª–∏ –≤—ã —Å–∏–ª—å–Ω–æ —à—É–º–µ–ª–∏ –∏ –≤–æ–ª–∫ –≤–∞—Å –Ω–∞—à—ë–ª -6");
            }

            let rareRun = Math.floor(Math.random() * 10) + 1;
            if (rareRun === 7) {
                e -= 9;
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í–∞—Å –æ–∫—Ä—É–∂–∏–ª–∞ —Å—Ç–∞—è –≤–æ–ª–∫–æ–≤ -9");
            }

            let rareGlobal = Math.floor(Math.random() * 15) + 1;
            if (rareGlobal === 1) {
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í—ã –Ω–∞—à–ª–∏ –ø–∏—Ä–æ–≥");
                inventory.push("–ø–∏—Ä–æ–≥");
                addLog("–ü–∏—Ä–æ–≥ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä—é–∫–∑–∞–∫!");
            } else if (rareGlobal === 2) {
                e -= 7;
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í—ã –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏ –º–µ–¥–≤–µ–¥—è -7");
            } else if (rareGlobal === 3) {
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í—ã –Ω–∞—à–ª–∏ –Ω–∞ —Ä–µ–¥–∫–æ—Å—Ç—å –≤–∫—É—Å–Ω–æ–µ —è–±–ª–æ–∫–æ");
                inventory.push("—è–±–ª–æ–∫–æ");
                addLog("–Ø–±–ª–æ–∫–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä—é–∫–∑–∞–∫!");
            } else if (rareGlobal === 4) {
                e -= 2;
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í–∞—Å —É–∫—É—Å–∏–ª –∫–æ–º–∞—Ä -2 —ç–Ω–µ—Ä–≥–∏–∏");
            }

            let rareCompass = Math.floor(Math.random() * 20) + 1;
            if (rareCompass === 20) {
                addLog("–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í—ã –Ω–∞—à–ª–∏ –∫–æ–º–ø–∞—Å!");
                inventory.push("–∫–æ–º–ø–∞—Å");
                addLog("–ö–æ–º–ø–∞—Å –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä—é–∫–∑–∞–∫!");
            }

            if (hod % 6 === 0) {
                let found = randomChoice(loot);
                addLog(`–í—ã –Ω–∞—à–ª–∏: ${found}`);
                if (found === "—è–≥–æ–¥—ã") {
                    inventory.push("—è–≥–æ–¥—ã");
                    addLog("–Ø–≥–æ–¥—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ä—é–∫–∑–∞–∫!");
                } else if (found === "–æ—Ä–µ—à–∫–∏") {
                    inventory.push("–æ—Ä–µ—à–∫–∏");
                    addLog("–û—Ä–µ—à–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ä—é–∫–∑–∞–∫!");
                } else if (found === "—á–µ–π-—Ç–æ –±—É—Ç–µ—Ä–±—Ä–æ–¥") {
                    inventory.push("—á–µ–π-—Ç–æ –±—É—Ç–µ—Ä–±—Ä–æ–¥");
                    addLog("—á–µ–π-—Ç–æ –±—É—Ç–µ—Ä–±—Ä–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä—é–∫–∑–∞–∫!");
                }
            }

            if (inventory.includes("—Ç—Ä–æ—Å—Ç—å")) {
                e += 1;
                addLog("–° —Ç—Ä–æ—Å—Ç—å—é –≤–∞–º –ø—Ä–æ—â–µ +1");
                if (Math.floor(Math.random() * 10) + 1 === 10) {
                    removeOneFromInventory("—Ç—Ä–æ—Å—Ç—å");
                    addLog(randomChoice([
                        "–í–∞—à–∞ —Ç—Ä–æ—Å—Ç—å –∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é —Å–ª–æ–º–∞–ª–∞—Å—å",
                        "–í—ã –ø–æ—Ç–µ—Ä—è–ª–∏ —Å–≤–æ—é —Ç—Ä–æ—Å—Ç—å"
                    ]));
                }
            }
            if (inventory.includes("–∫–æ–º–ø–∞—Å") && Math.floor(Math.random() * 30) + 1 === 30) {
                removeOneFromInventory("–∫–æ–º–ø–∞—Å");
                addLog(randomChoice([
                    "–ö–æ–º–ø–∞—Å —É–ø–∞–ª –Ω–∞ –∫–∞–º–µ–Ω—å –∏ —Ä–∞–∑–±–∏–ª—Å—è",
                    "–í—ã –ø–æ—Ç–µ—Ä—è–ª–∏ —Å–≤–æ–π –∫–æ–º–ø–∞—Å"
                ]));
            }

            addLog(`–≠–Ω–µ—Ä–≥–∏—è: ${e}`);
            updateUI();
            checkWinLose();
        }

        function openInventoryPanel() {
            if (!gameActive) return;
            // –í—ã–≤–æ–¥–∏–º —Å—Ç–∞—Ç—É—Å –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ
            addLog("–°—Ç–∞—Ç—É—Å:");
            addLog(`–®–∞–≥–æ–≤ —Å–¥–µ–ª–∞–Ω–æ: ${steps}, –ü—Ä–æ–±–µ–∂–µ–∫: ${run}`);
            addLog("–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å: " + (inventory.length ? inventory.join(", ") : "–ø—É—Å—Ç–æ"));
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–µ—Å–ª–∏ –∑–∞–∫—Ä—ã—Ç–∞)
            if (useItemPanel.classList.contains('hidden')) {
                useItemPanel.classList.remove('hidden');
                // –°–Ω–∏–º–∞–µ–º —ç–Ω–µ—Ä–≥–∏—é –∑–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä —Ä—é–∫–∑–∞–∫–∞
                e -= 1;
                addLog("–ü–æ–∫–∞ –≤—ã –¥—É–º–∞–ª–∏ —á—Ç–æ –≤—ã —Å–¥–µ–ª–∞–ª–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è, –≤—ã —É—Å—Ç–∞–ª–∏ -1");
                updateUI();
                checkWinLose();
            }
        }

        function useItemFromInput() {
            if (!gameActive) return;
            const itemName = itemInput.value.trim().toLowerCase();
            itemInput.value = '';

            if (!itemName) {
                addLog("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞");
                return;
            }

            if (!inventory.includes(itemName)) {
                addLog(`–£ –≤–∞—Å –Ω–µ—Ç —ç—Ç–æ–≥–æ`); // —Ç–æ—á–Ω–æ –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ
                return;
            }

            // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
            if (itemName === "—è–≥–æ–¥—ã") {
                e += 2;
                removeOneFromInventory("—è–≥–æ–¥—ã");
                addLog("–í—ã —Å—ä–µ–ª–∏ —è–≥–æ–¥—ã +2");
            } else if (itemName === "–æ—Ä–µ—à–∫–∏") {
                e += 2;
                removeOneFromInventory("–æ—Ä–µ—à–∫–∏");
                addLog("–í—ã —Å—ä–µ–ª–∏ –æ—Ä–µ—à–∫–∏ +2");
            } else if (itemName === "—á–µ–π-—Ç–æ –±—É—Ç–µ—Ä–±—Ä–æ–¥") {
                e += 4;
                removeOneFromInventory("—á–µ–π-—Ç–æ –±—É—Ç–µ—Ä–±—Ä–æ–¥");
                addLog("–í—ã —Å—ä–µ–ª–∏ —á–µ–π-—Ç–æ –±—É—Ç–µ—Ä–±—Ä–æ–¥ +4");
            } else if (itemName === "–ø–∏—Ä–æ–≥") {
                e += 4;
                removeOneFromInventory("–ø–∏—Ä–æ–≥");
                addLog("–í—ã —Å—ä–µ–ª–∏ –ø–∏—Ä–æ–≥ +4");
            } else if (itemName === "—è–±–ª–æ–∫–æ") {
                e += 3;
                removeOneFromInventory("—è–±–ª–æ–∫–æ");
                addLog("–í—ã —Å—ä–µ–ª–∏ –≤–∫—É—Å–Ω–æ–µ —è–±–ª–æ–∫–æ +3");
            } else if (itemName === "—Ç—Ä–æ—Å—Ç—å") {
                addLog("–° —Ç—Ä–æ—Å—Ç—å—é —É–¥–æ–±–Ω–µ–µ, –Ω–æ –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ –µ—ë —Å—ä–µ—Å—Ç—å :)");
            } else if (itemName === "–∫–æ–º–ø–∞—Å") {
                addLog("–ö–æ–º–ø–∞—Å –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –Ω–∞–π—Ç–∏—Å—å, –Ω–æ –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ –µ–≥–æ —Å—ä–µ—Å—Ç—å :)");
            } else {
                addLog("–£ –≤–∞—Å –Ω–µ—Ç —ç—Ç–æ–≥–æ");
            }

            // –ü–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–Ω–∏–º–∞–µ–º –µ—â—ë 1 —ç–Ω–µ—Ä–≥–∏–∏ (–∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ)
            e -= 1;
            addLog("–ü–æ–∫–∞ –≤—ã –¥—É–º–∞–ª–∏ —á—Ç–æ –≤—ã —Å–¥–µ–ª–∞–ª–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è, –≤—ã —É—Å—Ç–∞–ª–∏ -1");

            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å
            useItemPanel.classList.add('hidden');

            updateUI();
            checkWinLose();
        }

        function closeUsePanel() {
            if (!gameActive) return;
            useItemPanel.classList.add('hidden');
            addLog("–í—ã –∑–∞–∫—Ä—ã–ª–∏ —Ä—é–∫–∑–∞–∫");
            // –ë–µ–∑ —Å–Ω—è—Ç–∏—è —ç–Ω–µ—Ä–≥–∏–∏ (—É–∂–µ —Å–Ω—è–ª–∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏)
            updateUI();
        }

        // –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
        goBtn.addEventListener('click', goAction);
        restBtn.addEventListener('click', restAction);
        runBtn.addEventListener('click', runAction);
        statusBtn.addEventListener('click', openInventoryPanel);
        useItemBtn.addEventListener('click', useItemFromInput);
        closeUsePanelBtn.addEventListener('click', closeUsePanel);
        itemInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') useItemFromInput();
        });

        // –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –∏–≥—Ä–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞
        disableButtons(true);
    })();
</script>
</body>
</html>